/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it uses a non-standard name for the exports (exports).
(() => {
var exports = __webpack_exports__;
/*!**************************!*\
  !*** ./spaceinvaders.ts ***!
  \**************************/

Object.defineProperty(exports, "__esModule", ({ value: true }));
function spaceinvaders() {
    const empty = 0;
    const player = 1;
    const invader = 2;
    const shot = 3;
    const noOfInvadersRows = 6;
    const gameObject = (x, y) => ({ x: x, y: y });
    const gameSize = 20;
    const clearGame = () => Array(gameSize).fill(empty).map(e => Array(gameSize).fill(empty));
    const createInvaders = () => Array.from(Array(noOfInvadersRows).keys())
        .reduce((invds, row) => [...invds, ...createRowOfInvaders(row)], []);
    const createRowOfInvaders = row => Array.from(Array(gameSize / 2).keys())
        .filter(e => row % 2 === 0 ? e % 2 === 0 : e % 2 !== 0)
        .map(e => gameObject(row, e + 4));
    const invadersDirection = (state) => state.invaders.length && state.invaders[0].y <= 0
        ? 1
        : (state.invaders.length && state.invaders[state.invaders.length - 1].y >= gameSize - 1
            ? -1
            : state.invadersDirY);
    const drawGame = (state) => (keepShipWithinGame(state),
        state.game = clearGame(),
        state.game[state.game.length - 1][state.shipY] = player,
        state.invaders.forEach(i => state.game[i.x][i.y] = invader),
        state.invadersShoots.forEach(s => state.game[s.x][s.y] = shot),
        state.shoots.forEach(s => state.game[s.x][s.y] = shot),
        state.game);
    const addInvaderShoot = state => (randomInvader => gameObject(randomInvader.x, randomInvader.y))(state.invaders[Math.floor(Math.random() * state.invaders.length)]);
    const collision = (e1, e2) => e1.x === e2.x && e1.y === e2.y;
    const filterOutCollisions = (c1, c2) => c1.filter(e1 => !c2.find(e2 => collision(e1, e2)));
    const updateScore = (state) => state.shoots.find(s => state.invaders.find(i => collision(s, i))) ? state.score + 1 : state.score;
    const updateState = (state) => ({
        delta: state.delta,
        game: drawGame(state),
        shipY: state.shipY,
        playerLives: state.invadersShoots.some(e => e.x === gameSize - 1 && e.y === state.shipY)
            ? state.playerLives - 1
            : state.playerLives,
        isGameOver: state.playerLives <= 0,
        score: updateScore(state),
        invadersDirY: invadersDirection(state),
        invaders: (!state.invaders.length
            ? createInvaders()
            : filterOutCollisions(state.invaders, state.shoots)
                .map(i => state.delta % 10 === 0
                ? gameObject(i.x + (state.delta % (state.shootFrequency + 10) === 0 ? 1 : 0), i.y + state.invadersDirY)
                : i)),
        invadersShoots: (state.invadersShoots = state.delta % state.shootFrequency === 0
            ? [...state.invadersShoots, addInvaderShoot(state)]
            : state.invadersShoots,
            state.invadersShoots
                .filter(e => e.x < gameSize - 1)
                .map(e => gameObject(e.x + 1, e.y))),
        shoots: filterOutCollisions(state.shoots, state.invaders)
            .filter(e => e.x > 0)
            .map(e => gameObject(e.x - 1, e.y)),
        shootFrequency: !state.invaders.length ? state.shootFrequency - 5 : state.shootFrequency
    });
    const keepShipWithinGame = (state) => (state.shipY = state.shipY < 0 ? 0 : state.shipY,
        state.shipY = state.shipY >= gameSize - 1 ? gameSize - 1 : state.shipY);
    const updateShipY = (state, input) => input.key !== 'ArrowLeft' && input.key !== 'ArrowRight'
        ? state.shipY
        : (state.shipY -= input.key === 'ArrowLeft' ? 1 : -1);
    const addShots = (state, input) => state.shoots = input.key === 'Space'
        ? [...state.shoots, gameObject(gameSize - 2, state.shipY)]
        : state.shoots;
    const isGameOver = (state) => state.playerLives <= 0
        || (state.invaders.length
            && state.invaders[state.invaders.length - 1].x >= gameSize - 1);
    const initialState = {
        delta: 0,
        game: clearGame(),
        shipY: 10,
        playerLives: 3,
        isGameOver: false,
        score: 0,
        invadersDirY: 1,
        invaders: createInvaders(),
        invadersShoots: [],
        shoots: [],
        shootFrequency: 20
    };
    const processInput = (state, input) => (updateShipY(state, input),
        addShots(state, input));
    const whileNotGameOver = (state, input) => state.delta = isGameOver(state) ? undefined : input.dlta;
    const gameUpdate = (state, input) => (whileNotGameOver(state, input),
        processInput(state, input),
        updateState(state));
    const createElem = col => {
        const elem = document.createElement('div');
        elem.classList.add('board');
        elem.style.display = 'inline-block';
        elem.style.marginLeft = '10px';
        elem.style.height = '6px';
        elem.style.width = '6px';
        elem.style['background-color'] =
            col === empty
                ? 'white'
                : (col === player
                    ? 'cornflowerblue'
                    : col === invader
                        ? 'gray'
                        : 'silver');
        elem.style['border-radius'] = '90%';
        return elem;
    };
    const paint = (game, playerLives, score, isGameOver) => {
        document.body.innerHTML = '';
        document.body.innerHTML += `Score: ${score} Lives: ${playerLives}`;
        if (isGameOver) {
            document.body.innerHTML += ' GAME OVER!';
            return;
        }
        game.forEach(row => {
            const rowContainer = document.createElement('div');
            row.forEach(col => rowContainer.appendChild(createElem(col)));
            document.body.appendChild(rowContainer);
        });
        const createElem = col => {
            const elem = document.createElement('div');
            elem.classList.add('board');
            elem.style.display = 'inline-block';
            elem.style.marginLeft = '10px';
            elem.style.height = '6px';
            elem.style.width = '6px';
            elem.style['background-color'] =
                col === empty
                    ? 'white'
                    : (col === player
                        ? 'cornflowerblue'
                        : col === invader
                            ? 'gray'
                            : 'silver');
            elem.style['border-radius'] = '90%';
            return elem;
        };
        const paint = (game, playerLives, score, isGameOver) => {
            document.body.innerHTML = '';
            document.body.innerHTML += `Score: ${score} Lives: ${playerLives}`;
            if (isGameOver) {
                document.body.innerHTML += ' GAME OVER!';
                return;
            }
            game.forEach(row => {
                const rowContainer = document.createElement('div');
                row.forEach(col => rowContainer.appendChild(createElem(col)));
                document.body.appendChild(rowContainer);
            });
        };
    };
}
// the following simply runs your pong function on window load.  Make sure to leave it in place.
if (typeof window != 'undefined')
    window.onload = () => {
        spaceinvaders();
    };

})();

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEdBQUcsT0FBTyxDQUFDO1FBQzNELEtBQUssQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQztRQUM5RCxLQUFLLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUM7UUFDdEQsS0FBSyxDQUFDLElBQUksQ0FDWCxDQUFDO0lBRUYsTUFBTSxlQUFlLEdBQUcsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQyxDQUFDLEVBQUUsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQzdGLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFFdEUsTUFBTSxTQUFTLEdBQUcsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQzdELE1BQU0sbUJBQW1CLEdBQUcsQ0FBQyxFQUFTLEVBQUUsRUFBUyxFQUFTLEVBQUUsQ0FDMUQsRUFBRSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLFNBQVMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3JELE1BQU0sV0FBVyxHQUFH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QUMsZUFBZSxDQUFDLEdBQUcsS0FBSyxDQUFDO1lBQ3BDLE9BQU8sSUFBSSxDQUFDO1FBQ2QsQ0FBQztRQUVBLE1BQU0sS0FBSyxHQUFHLENBQUMsSUFBZ0IsRUFBRSxXQUFtQixFQUFFLEtBQWEsRUFBRSxVQUFtQixFQUFFLEVBQUU7WUFDM0YsUUFBUSxDQUFDLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDO1lBQzdCLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLFVBQVUsS0FBSyxXQUFXLFdBQVcsRUFBRSxDQUFDO1lBRW5FLElBQUksVUFBVSxFQUFFO2dCQUNkLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLGFBQWEsQ0FBQztnQkFDekMsT0FBTzthQUNSO1lBRUQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRTtnQkFDakIsTUFBTSxZQUFZLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDbkQsR0FBRyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLFlBQVksQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDOUQsUUFBUSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLENBQUM7WUFDMUMsQ0FBQyxDQUFDLENBQUM7UUFFTCxDQUFDLENBQUM7SUFDSixDQUFDLENBQUM7QUFDRixDQUFDO0FBRUMsZ0dBQWdHO0FBQ2hHLElBQUksT0FBTyxNQUFNLElBQUksV0FBVztJQUM5QixNQUFNLENBQUMsTUFBTSxHQUFHLEdBQUUsRUFBRTtRQUNsQixhQUFhLEVBQUUsQ0FBQztJQUNsQixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3BhY2VpbnZhZGVycy8uL3NwYWNlaW52YWRlcnMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZnJvbUV2ZW50LCBpbnRlcnZhbCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgbWFwLCBzY2FuLCB0YXAsIHN0YXJ0V2l0aCwgd2l0aExhdGVzdEZyb20sIHRha2VVbnRpbCwgcmVwZWF0IH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5cbmZ1bmN0aW9uIHNwYWNlaW52YWRlcnMoKSB7XG4gICAgLy8gSW5zaWRlIHRoaXMgZnVuY3Rpb24geW91IHdpbGwgdXNlIHRoZSBjbGFzc2VzIGFuZCBmdW5jdGlvbnMgXG4gICAgLy8gZnJvbSByeC5qc1xuICAgIC8vIHRvIGFkZCB2aXN1YWxzIHRvIHRoZSBzdmcgZWxlbWVudCBpbiBwb25nLmh0bWwsIGFuaW1hdGUgdGhlbSwgYW5kIG1ha2UgdGhlbSBpbnRlcmFjdGl2ZS5cbiAgICAvLyBTdHVkeSBhbmQgY29tcGxldGUgdGhlIHRhc2tzIGluIG9ic2VydmFibGUgZXhhbXBlbHMgZmlyc3QgdG8gZ2V0IGlkZWFzLlxuICAgIC8vIENvdXJzZSBOb3RlcyBzaG93aW5nIEFzdGVyb2lkcyBpbiBGUlA6IGh0dHBzOi8vdGdkd3llci5naXRodWIuaW8vYXN0ZXJvaWRzLyBcbiAgICAvLyBZb3Ugd2lsbCBiZSBtYXJrZWQgb24geW91ciBmdW5jdGlvbmFsIHByb2dyYW1taW5nIHN0eWxlXG4gICAgLy8gYXMgd2VsbCBhcyB0aGUgZnVuY3Rpb25hbGl0eSB0aGF0IHlvdSBpbXBsZW1lbnQuXG4gICAgLy8gRG9jdW1lbnQgeW91ciBjb2RlISAgXG4gIHR5cGUgS2V5ID0gJ0Fycm93TGVmdCcgfCAnQXJyb3dSaWdodCcgfCAnU3BhY2UnXG4gIHR5cGUgVmlld1R5cGUgPSAnc2hpcCcgfCAnYWxpZW5zJyB8ICdidWxsZXQnXG4gICAgaW50ZXJmYWNlIFN0YXRlIHtcbiAgICBkZWx0YTogbnVtYmVyLFxuICAgIGdhbWU6IG51bWJlcltdW107XG4gICAgc2hpcFk6IG51bWJlcjtcbiAgICBwbGF5ZXJMaXZlczogbnVtYmVyO1xuICAgIGlzR2FtZU92ZXI6IGJvb2xlYW47XG4gICAgc2NvcmU6IG51bWJlcjtcbiAgICBpbnZhZGVyc0Rpclk6IG51bWJlcixcbiAgICBpbnZhZGVyczogYW55W107XG4gICAgaW52YWRlcnNTaG9vdHM6IGFueVtdO1xuICAgIHNob290czogYW55W107XG4gICAgc2hvb3RGcmVxdWVuY3k6IG51bWJlcjtcbiAgfVxuICBcbiAgIGludGVyZmFjZSBJbnB1dCB7XG4gICAgZGx0YTogbnVtYmVyLCBrZXk6IHN0cmluZ1xuICB9XG4gIGNvbnN0IGVtcHR5ID0gMDtcbiAgY29uc3QgcGxheWVyID0gMTtcbiAgY29uc3QgaW52YWRlciA9IDI7XG4gIGNvbnN0IHNob3QgPSAzO1xuICBjb25zdCBub09mSW52YWRlcnNSb3dzID0gNjtcbiAgXG5jb25zdCBnYW1lT2JqZWN0ID0gKHgsIHkpID0+ICh7IHg6IHgsIHk6IHkgfSk7XG5jb25zdCBnYW1lU2l6ZSA9IDIwO1xuY29uc3QgY2xlYXJHYW1lID0gKCkgPT4gQXJyYXkoZ2FtZVNpemUpLmZpbGwoZW1wdHkpLm1hcChlID0+IEFycmF5KGdhbWVTaXplKS5maWxsKGVtcHR5KSk7XG5cbmNvbnN0IGNyZWF0ZUludmFkZXJzID0gKCkgPT4gQXJyYXkuZnJvbShBcnJheShub09mSW52YWRlcnNSb3dzKS5rZXlzKCkpXG4gIC5yZWR1Y2UoKGludmRzLCByb3cpID0+IFsuLi5pbnZkcywgLi4uY3JlYXRlUm93T2ZJbnZhZGVycyhyb3cpXSwgW10pXG5jb25zdCBjcmVhdGVSb3dPZkludmFkZXJzID0gcm93ID0+IEFycmF5LmZyb20oQXJyYXkoZ2FtZVNpemUgLyAyKS5rZXlzKCkpXG4gIC5maWx0ZXIoZSA9PiByb3cgJSAyID09PSAwID8gZSAlIDIgPT09IDAgOiBlICUgMiAhPT0gMClcbiAgLm1hcChlID0+IGdhbWVPYmplY3Qocm93LCBlICsgNCkpO1xuXG5jb25zdCBpbnZhZGVyc0RpcmVjdGlvbiA9IChzdGF0ZTogU3RhdGUpOiBudW1iZXIgPT5cbiAgc3RhdGUuaW52YWRlcnMubGVuZ3RoICYmIHN0YXRlLmludmFkZXJzWzBdLnkgPD0gMFxuICAgID8gMVxuICAgIDogKHN0YXRlLmludmFkZXJzLmxlbmd0aCAmJiBzdGF0ZS5pbnZhZGVyc1tzdGF0ZS5pbnZhZGVycy5sZW5ndGggLSAxXS55ID49IGdhbWVTaXplIC0gMVxuICAgICAgPyAtMVxuICAgICAgOiBzdGF0ZS5pbnZhZGVyc0RpclkpO1xuXG5jb25zdCBkcmF3R2FtZSA9IChzdGF0ZTogU3RhdGUpOiBudW1iZXJbXVtdID0+IChcbiAga2VlcFNoaXBXaXRoaW5HYW1lKHN0YXRlKSxcbiAgc3RhdGUuZ2FtZSA9IGNsZWFyR2FtZSgpLFxuICBzdGF0ZS5nYW1lW3N0YXRlLmdhbWUubGVuZ3RoIC0gMV1bc3RhdGUuc2hpcFldID0gcGxheWVyLFxuICBzdGF0ZS5pbnZhZGVycy5mb3JFYWNoKGkgPT4gc3RhdGUuZ2FtZVtpLnhdW2kueV0gPSBpbnZhZGVyKSxcbiAgc3RhdGUuaW52YWRlcnNTaG9vdHMuZm9yRWFjaChzID0+IHN0YXRlLmdhbWVbcy54XVtzLnldID0gc2hvdCksXG4gIHN0YXRlLnNob290cy5mb3JFYWNoKHMgPT4gc3RhdGUuZ2FtZVtzLnhdW3MueV0gPSBzaG90KSxcbiAgc3RhdGUuZ2FtZVxuKTtcblxuY29uc3QgYWRkSW52YWRlclNob290ID0gc3RhdGUgPT4gKHJhbmRvbUludmFkZXIgPT4gZ2FtZU9iamVjdChyYW5kb21JbnZhZGVyLngsIHJhbmRvbUludmFkZXIueSkpXG4gIChzdGF0ZS5pbnZhZGVyc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBzdGF0ZS5pbnZhZGVycy5sZW5ndGgpXSk7XG5cbmNvbnN0IGNvbGxpc2lvbiA9IChlMSwgZTIpID0+IGUxLnggPT09IGUyLnggJiYgZTEueSA9PT0gZTIueTtcbmNvbnN0IGZpbHRlck91dENvbGxpc2lvbnMgPSAoYzE6IGFueVtdLCBjMjogYW55W10pOiBhbnlbXSA9PlxuICBjMS5maWx0ZXIoZTEgPT4gIWMyLmZpbmQoZTIgPT4gY29sbGlzaW9uKGUxLCBlMikpKTtcbmNvbnN0IHVwZGF0ZVNjb3JlID0gKHN0YXRlOiBTdGF0ZSk6IG51bWJlciA9PlxuICBzdGF0ZS5zaG9vdHMuZmluZChzID0+IHN0YXRlLmludmFkZXJzLmZpbmQoaSA9PiBjb2xsaXNpb24ocywgaSkpKSA/IHN0YXRlLnNjb3JlICsgMSA6IHN0YXRlLnNjb3JlO1xuXG5jb25zdCB1cGRhdGVTdGF0ZSA9IChzdGF0ZTogU3RhdGUpOiBTdGF0ZSA9PiAoe1xuICBkZWx0YTogc3RhdGUuZGVsdGEsXG4gIGdhbWU6IGRyYXdHYW1lKHN0YXRlKSxcbiAgc2hpcFk6IHN0YXRlLnNoaXBZLFxuICBwbGF5ZXJMaXZlczogc3RhdGUuaW52YWRlcnNTaG9vdHMuc29tZShlID0+IGUueCA9PT0gZ2FtZVNpemUgLSAxICYmIGUueSA9PT0gc3RhdGUuc2hpcFkpXG4gICAgPyBzdGF0ZS5wbGF5ZXJMaXZlcyAtIDFcbiAgICA6IHN0YXRlLnBsYXllckxpdmVzLFxuICBpc0dhbWVPdmVyOiBzdGF0ZS5wbGF5ZXJMaXZlcyA8PSAwLFxuICBzY29yZTogdXBkYXRlU2NvcmUoc3RhdGUpLFxuICBpbnZhZGVyc0Rpclk6IGludmFkZXJzRGlyZWN0aW9uKHN0YXRlKSxcbiAgaW52YWRlcnM6ICghc3RhdGUuaW52YWRlcnMubGVuZ3RoXG4gICAgPyBjcmVhdGVJbnZhZGVycygpXG4gICAgOiBmaWx0ZXJPdXRDb2xsaXNpb25zKHN0YXRlLmludmFkZXJzLCBzdGF0ZS5zaG9vdHMpXG4gICAgICAubWFwKGkgPT4gc3RhdGUuZGVsdGEgJSAxMCA9PT0gMFxuICAgICAgICA/IGdhbWVPYmplY3QoXG4gICAgICAgICAgaS54ICsgKHN0YXRlLmRlbHRhICUgKHN0YXRlLnNob290RnJlcXVlbmN5ICsgMTApID09PSAwID8gMSA6IDApLFxuICAgICAgICAgIGkueSArIHN0YXRlLmludmFkZXJzRGlyWSlcbiAgICAgICAgOiBpKSksXG4gIGludmFkZXJzU2hvb3RzOiAoXG4gICAgc3RhdGUuaW52YWRlcnNTaG9vdHMgPSBzdGF0ZS5kZWx0YSAlIHN0YXRlLnNob290RnJlcXVlbmN5ID09PSAwXG4gICAgICA/IFsuLi5zdGF0ZS5pbnZhZGVyc1Nob290cywgYWRkSW52YWRlclNob290KHN0YXRlKV1cbiAgICAgIDogc3RhdGUuaW52YWRlcnNTaG9vdHMsXG4gICAgc3RhdGUuaW52YWRlcnNTaG9vdHNcbiAgICAgIC5maWx0ZXIoZSA9PiBlLnggPCBnYW1lU2l6ZSAtIDEpXG4gICAgICAubWFwKGUgPT4gZ2FtZU9iamVjdChlLnggKyAxLCBlLnkpKVxuICApLFxuICBzaG9vdHM6IGZpbHRlck91dENvbGxpc2lvbnMoc3RhdGUuc2hvb3RzLCBzdGF0ZS5pbnZhZGVycylcbiAgICAuZmlsdGVyKGUgPT4gZS54ID4gMClcbiAgICAubWFwKGUgPT4gZ2FtZU9iamVjdChlLnggLSAxLCBlLnkpKSxcbiAgc2hvb3RGcmVxdWVuY3k6ICFzdGF0ZS5pbnZhZGVycy5sZW5ndGggPyBzdGF0ZS5zaG9vdEZyZXF1ZW5jeSAtIDUgOiBzdGF0ZS5zaG9vdEZyZXF1ZW5jeVxufSk7XG5cbmNvbnN0IGtlZXBTaGlwV2l0aGluR2FtZSA9IChzdGF0ZTogU3RhdGUpOiBudW1iZXIgPT4gKFxuICBzdGF0ZS5zaGlwWSA9IHN0YXRlLnNoaXBZIDwgMCA/IDAgOiBzdGF0ZS5zaGlwWSxcbiAgc3RhdGUuc2hpcFkgPSBzdGF0ZS5zaGlwWSA+PSBnYW1lU2l6ZSAtIDEgPyBnYW1lU2l6ZSAtIDEgOiBzdGF0ZS5zaGlwWVxuKTtcblxuY29uc3QgdXBkYXRlU2hpcFkgPSAoc3RhdGU6IFN0YXRlLCBpbnB1dDogSW5wdXQpOiBudW1iZXIgPT5cbiAgaW5wdXQua2V5ICE9PSAnQXJyb3dMZWZ0JyAmJiBpbnB1dC5rZXkgIT09ICdBcnJvd1JpZ2h0J1xuICAgID8gc3RhdGUuc2hpcFlcbiAgICA6IChzdGF0ZS5zaGlwWSAtPSBpbnB1dC5rZXkgPT09ICdBcnJvd0xlZnQnID8gMSA6IC0xKTtcblxuY29uc3QgYWRkU2hvdHMgPSAoc3RhdGU6IFN0YXRlLCBpbnB1dDogSW5wdXQpID0+XG4gIHN0YXRlLnNob290cyA9IGlucHV0LmtleSA9PT0gJ1NwYWNlJ1xuICAgID8gWy4uLnN0YXRlLnNob290cywgZ2FtZU9iamVjdChnYW1lU2l6ZSAtIDIsIHN0YXRlLnNoaXBZKV1cbiAgICA6IHN0YXRlLnNob290cztcblxuY29uc3QgaXNHYW1lT3ZlciA9IChzdGF0ZTogU3RhdGUpOiBib29sZWFuID0+XG4gIHN0YXRlLnBsYXllckxpdmVzIDw9IDBcbiAgfHwgKHN0YXRlLmludmFkZXJzLmxlbmd0aFxuICAgICYmIHN0YXRlLmludmFkZXJzW3N0YXRlLmludmFkZXJzLmxlbmd0aCAtIDFdLnggPj0gZ2FtZVNpemUgLSAxXG4gICk7XG5cbiBjb25zdCBpbml0aWFsU3RhdGU6IFN0YXRlID0ge1xuICBkZWx0YTogMCxcbiAgZ2FtZTogY2xlYXJHYW1lKCksXG4gIHNoaXBZOiAxMCxcbiAgcGxheWVyTGl2ZXM6IDMsXG4gIGlzR2FtZU92ZXI6IGZhbHNlLFxuICBzY29yZTogMCxcbiAgaW52YWRlcnNEaXJZOiAxLFxuICBpbnZhZGVyczogY3JlYXRlSW52YWRlcnMoKSxcbiAgaW52YWRlcnNTaG9vdHM6IFtdLFxuICBzaG9vdHM6IFtdLFxuICBzaG9vdEZyZXF1ZW5jeTogMjBcbn07XG5cbmNvbnN0IHByb2Nlc3NJbnB1dCA9IChzdGF0ZTogU3RhdGUsIGlucHV0OiBJbnB1dCkgPT4gKFxuICB1cGRhdGVTaGlwWShzdGF0ZSwgaW5wdXQpLFxuICBhZGRTaG90cyhzdGF0ZSwgaW5wdXQpXG4pO1xuY29uc3Qgd2hpbGVOb3RHYW1lT3ZlciA9IChzdGF0ZTogU3RhdGUsIGlucHV0OiBJbnB1dCkgPT5cbiAgc3RhdGUuZGVsdGEgPSBpc0dhbWVPdmVyKHN0YXRlKSA/IHVuZGVmaW5lZCA6IGlucHV0LmRsdGE7XG5cbiAgY29uc3QgZ2FtZVVwZGF0ZSA9IChzdGF0ZTogU3RhdGUsIGlucHV0OiBJbnB1dCk6IFN0YXRlID0+XG4gIChcbiAgICB3aGlsZU5vdEdhbWVPdmVyKHN0YXRlLCBpbnB1dCksXG4gICAgcHJvY2Vzc0lucHV0KHN0YXRlLCBpbnB1dCksXG4gICAgdXBkYXRlU3RhdGUoc3RhdGUpXG4gICk7XG4gIFxuY29uc3QgY3JlYXRlRWxlbSA9IGNvbCA9PiB7XG4gIGNvbnN0IGVsZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgZWxlbS5jbGFzc0xpc3QuYWRkKCdib2FyZCcpO1xuICBlbGVtLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJztcbiAgZWxlbS5zdHlsZS5tYXJnaW5MZWZ0ID0gJzEwcHgnO1xuICBlbGVtLnN0eWxlLmhlaWdodCA9ICc2cHgnO1xuICBlbGVtLnN0eWxlLndpZHRoID0gJzZweCc7XG4gIGVsZW0uc3R5bGVbJ2JhY2tncm91bmQtY29sb3InXSA9XG4gICAgY29sID09PSBlbXB0eVxuICAgICAgPyAnd2hpdGUnXG4gICAgICA6IChjb2wgPT09IHBsYXllclxuICAgICAgICA/ICdjb3JuZmxvd2VyYmx1ZSdcbiAgICAgICAgOiBjb2wgPT09IGludmFkZXJcbiAgICAgICAgICA/ICdncmF5J1xuICAgICAgICAgIDogJ3NpbHZlcicpO1xuICBlbGVtLnN0eWxlWydib3JkZXItcmFkaXVzJ10gPSAnOTAlJztcbiAgcmV0dXJuIGVsZW07XG59XG5cblxuIGNvbnN0IHBhaW50ID0gKGdhbWU6IG51bWJlcltdW10sIHBsYXllckxpdmVzOiBudW1iZXIsIHNjb3JlOiBudW1iZXIsIGlzR2FtZU92ZXI6IGJvb2xlYW4pID0+IHtcbiAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSAnJztcbiAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgKz0gYFNjb3JlOiAke3Njb3JlfSBMaXZlczogJHtwbGF5ZXJMaXZlc31gO1xuXG4gIGlmIChpc0dhbWVPdmVyKSB7XG4gICAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgKz0gJyBHQU1FIE9WRVIhJztcbiAgICByZXR1cm47XG4gIH1cblxuICBnYW1lLmZvckVhY2gocm93ID0+IHtcbiAgICBjb25zdCByb3dDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICByb3cuZm9yRWFjaChjb2wgPT4gcm93Q29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUVsZW0oY29sKSkpO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocm93Q29udGFpbmVyKTtcbiAgfSk7XG4gIGNvbnN0IGNyZWF0ZUVsZW0gPSBjb2wgPT4ge1xuICAgIGNvbnN0IGVsZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBlbGVtLmNsYXNzTGlzdC5hZGQoJ2JvYXJkJyk7XG4gICAgZWxlbS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7XG4gICAgZWxlbS5zdHlsZS5tYXJnaW5MZWZ0ID0gJzEwcHgnO1xuICAgIGVsZW0uc3R5bGUuaGVpZ2h0ID0gJzZweCc7XG4gICAgZWxlbS5zdHlsZS53aWR0aCA9ICc2cHgnO1xuICAgIGVsZW0uc3R5bGVbJ2JhY2tncm91bmQtY29sb3InXSA9XG4gICAgICBjb2wgPT09IGVtcHR5XG4gICAgICAgID8gJ3doaXRlJ1xuICAgICAgICA6IChjb2wgPT09IHBsYXllclxuICAgICAgICAgID8gJ2Nvcm5mbG93ZXJibHVlJ1xuICAgICAgICAgIDogY29sID09PSBpbnZhZGVyXG4gICAgICAgICAgICA/ICdncmF5J1xuICAgICAgICAgICAgOiAnc2lsdmVyJyk7XG4gICAgZWxlbS5zdHlsZVsnYm9yZGVyLXJhZGl1cyddID0gJzkwJSc7XG4gICAgcmV0dXJuIGVsZW07XG4gIH1cbiAgXG4gICBjb25zdCBwYWludCA9IChnYW1lOiBudW1iZXJbXVtdLCBwbGF5ZXJMaXZlczogbnVtYmVyLCBzY29yZTogbnVtYmVyLCBpc0dhbWVPdmVyOiBib29sZWFuKSA9PiB7XG4gICAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSAnJztcbiAgICBkb2N1bWVudC5ib2R5LmlubmVySFRNTCArPSBgU2NvcmU6ICR7c2NvcmV9IExpdmVzOiAke3BsYXllckxpdmVzfWA7XG4gIFxuICAgIGlmIChpc0dhbWVPdmVyKSB7XG4gICAgICBkb2N1bWVudC5ib2R5LmlubmVySFRNTCArPSAnIEdBTUUgT1ZFUiEnO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgXG4gICAgZ2FtZS5mb3JFYWNoKHJvdyA9PiB7XG4gICAgICBjb25zdCByb3dDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIHJvdy5mb3JFYWNoKGNvbCA9PiByb3dDb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlRWxlbShjb2wpKSk7XG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHJvd0NvbnRhaW5lcik7XG4gICAgfSk7XG4gIFxuICB9O1xufTtcbn1cbiAgXG4gIC8vIHRoZSBmb2xsb3dpbmcgc2ltcGx5IHJ1bnMgeW91ciBwb25nIGZ1bmN0aW9uIG9uIHdpbmRvdyBsb2FkLiAgTWFrZSBzdXJlIHRvIGxlYXZlIGl0IGluIHBsYWNlLlxuICBpZiAodHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJylcbiAgICB3aW5kb3cub25sb2FkID0gKCk9PntcbiAgICAgIHNwYWNlaW52YWRlcnMoKTtcbiAgICB9XG4gIFxuXG5cblxuXG5cblxuIFxuICBcbiAgXG5cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==